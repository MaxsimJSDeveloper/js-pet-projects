{"version":3,"file":"commonHelpers8.js","sources":["../src/js/timer.js"],"sourcesContent":["import flatpickr from 'flatpickr';\nimport 'flatpickr/dist/flatpickr.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst timeInFuture = document.querySelector('#datetime-picker');\n\nconst options = {\n  enableTime: true,\n  time_24hr: true,\n  defaultDate: new Date(),\n  minuteIncrement: 1,\n  onClose: function (selectedDates) {\n    currentDifferenceDate(selectedDates[0]);\n  },\n};\n\nflatpickr(timeInFuture, options);\n\nconst btnStartRef = document.querySelector('[data-start]');\nconst daysRef = document.querySelector('[data-days]');\nconst hoursRef = document.querySelector('[data-hours]');\nconst minutesRef = document.querySelector('[data-minutes]');\nconst secondsRef = document.querySelector('[data-seconds]');\n\nlet timerId = null;\n\nbtnStartRef.setAttribute('disabled', true);\nbtnStartRef.classList.add('start-button-dis');\nbtnStartRef.addEventListener('click', onBtnStart);\n\nfunction onBtnStart() {\n  const futureTime = new Date(timeInFuture.value).getTime();\n  startTimer(futureTime);\n}\n\nfunction startTimer(futureTime) {\n  btnStartRef.setAttribute('disabled', true);\n  btnStartRef.classList.add('start-button-dis');\n  timeInFuture.setAttribute('disabled', true);\n\n  const currentTime = Date.now();\n  const diff = futureTime - currentTime;\n\n  if (diff <= 0) {\n    iziToast.success({\n      title: 'OK',\n      message: 'Successfully inserted record!',\n      position: 'topRight',\n    });\n    clearTimeout(timerId);\n    return;\n  }\n\n  renderDate(convertMs(diff));\n\n  timerId = setTimeout(() => {\n    startTimer(futureTime);\n  }, 1000);\n}\n\nfunction currentDifferenceDate(selectedDate) {\n  const currentDate = Date.now();\n\n  if (selectedDate < currentDate) {\n    btnStartRef.setAttribute('disabled', true);\n    btnStartRef.classList.add('start-button-dis');\n    clearTimeout(timerId);\n    return iziToast.error({\n      title: 'Error',\n      message: 'Please choose a date in the future',\n      position: 'topRight',\n    });\n  }\n\n  const timeDifference = selectedDate.getTime() - currentDate;\n  const formatDate = convertMs(timeDifference);\n\n  renderDate(formatDate);\n  btnStartRef.removeAttribute('disabled');\n  btnStartRef.classList.remove('start-button-dis');\n}\n\nfunction renderDate(formatDate) {\n  secondsRef.textContent = formatDate.seconds;\n  minutesRef.textContent = formatDate.minutes;\n  hoursRef.textContent = formatDate.hours;\n  daysRef.textContent = formatDate.days;\n}\n\nfunction convertMs(ms) {\n  const seconds = Math.floor(ms / 1000) % 60;\n  const minutes = Math.floor(ms / (1000 * 60)) % 60;\n  const hours = Math.floor(ms / (1000 * 60 * 60)) % 24;\n  const days = Math.floor(ms / (1000 * 60 * 60 * 24));\n  return {\n    days: days < 10 ? '0' + days : days,\n    hours: hours < 10 ? '0' + hours : hours,\n    minutes: minutes < 10 ? '0' + minutes : minutes,\n    seconds: seconds < 10 ? '0' + seconds : seconds,\n  };\n}\n"],"names":["timeInFuture","options","selectedDates","currentDifferenceDate","flatpickr","btnStartRef","daysRef","hoursRef","minutesRef","secondsRef","timerId","onBtnStart","futureTime","startTimer","currentTime","diff","iziToast","renderDate","convertMs","selectedDate","currentDate","timeDifference","formatDate","ms","seconds","minutes","hours","days"],"mappings":"+IAKA,MAAMA,EAAe,SAAS,cAAc,kBAAkB,EAExDC,EAAU,CACd,WAAY,GACZ,UAAW,GACX,YAAa,IAAI,KACjB,gBAAiB,EACjB,QAAS,SAAUC,EAAe,CAChCC,EAAsBD,EAAc,CAAC,CAAC,CACvC,CACH,EAEAE,EAAUJ,EAAcC,CAAO,EAE/B,MAAMI,EAAc,SAAS,cAAc,cAAc,EACnDC,EAAU,SAAS,cAAc,aAAa,EAC9CC,EAAW,SAAS,cAAc,cAAc,EAChDC,EAAa,SAAS,cAAc,gBAAgB,EACpDC,EAAa,SAAS,cAAc,gBAAgB,EAE1D,IAAIC,EAAU,KAEdL,EAAY,aAAa,WAAY,EAAI,EACzCA,EAAY,UAAU,IAAI,kBAAkB,EAC5CA,EAAY,iBAAiB,QAASM,CAAU,EAEhD,SAASA,GAAa,CACpB,MAAMC,EAAa,IAAI,KAAKZ,EAAa,KAAK,EAAE,UAChDa,EAAWD,CAAU,CACvB,CAEA,SAASC,EAAWD,EAAY,CAC9BP,EAAY,aAAa,WAAY,EAAI,EACzCA,EAAY,UAAU,IAAI,kBAAkB,EAC5CL,EAAa,aAAa,WAAY,EAAI,EAE1C,MAAMc,EAAc,KAAK,MACnBC,EAAOH,EAAaE,EAE1B,GAAIC,GAAQ,EAAG,CACbC,EAAS,QAAQ,CACf,MAAO,KACP,QAAS,gCACT,SAAU,UAChB,CAAK,EACD,aAAaN,CAAO,EACpB,MACD,CAEDO,EAAWC,EAAUH,CAAI,CAAC,EAE1BL,EAAU,WAAW,IAAM,CACzBG,EAAWD,CAAU,CACtB,EAAE,GAAI,CACT,CAEA,SAAST,EAAsBgB,EAAc,CAC3C,MAAMC,EAAc,KAAK,MAEzB,GAAID,EAAeC,EACjB,OAAAf,EAAY,aAAa,WAAY,EAAI,EACzCA,EAAY,UAAU,IAAI,kBAAkB,EAC5C,aAAaK,CAAO,EACbM,EAAS,MAAM,CACpB,MAAO,QACP,QAAS,qCACT,SAAU,UAChB,CAAK,EAGH,MAAMK,EAAiBF,EAAa,QAAO,EAAKC,EAC1CE,EAAaJ,EAAUG,CAAc,EAE3CJ,EAAWK,CAAU,EACrBjB,EAAY,gBAAgB,UAAU,EACtCA,EAAY,UAAU,OAAO,kBAAkB,CACjD,CAEA,SAASY,EAAWK,EAAY,CAC9Bb,EAAW,YAAca,EAAW,QACpCd,EAAW,YAAcc,EAAW,QACpCf,EAAS,YAAce,EAAW,MAClChB,EAAQ,YAAcgB,EAAW,IACnC,CAEA,SAASJ,EAAUK,EAAI,CACrB,MAAMC,EAAU,KAAK,MAAMD,EAAK,GAAI,EAAI,GAClCE,EAAU,KAAK,MAAMF,GAAM,IAAO,GAAG,EAAI,GACzCG,EAAQ,KAAK,MAAMH,GAAM,IAAO,GAAK,GAAG,EAAI,GAC5CI,EAAO,KAAK,MAAMJ,GAAM,IAAO,GAAK,GAAK,GAAG,EAClD,MAAO,CACL,KAAMI,EAAO,GAAK,IAAMA,EAAOA,EAC/B,MAAOD,EAAQ,GAAK,IAAMA,EAAQA,EAClC,QAASD,EAAU,GAAK,IAAMA,EAAUA,EACxC,QAASD,EAAU,GAAK,IAAMA,EAAUA,CAC5C,CACA"}